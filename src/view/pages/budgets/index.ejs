<!DOCTYPE html>
<html lang="en" dir="ltr">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<title><%= title %></title>
	<script src="https://cdn.tailwindcss.com"></script>
	<link rel="preconnect" href="https://fonts.googleapis.com">
	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
	<style>
		body { font-family: Inter, system-ui, -apple-system, Segoe UI, Roboto, Arial; }
	</style>
</head>
<body class="bg-slate-50 text-slate-900">
	<header class="border-b bg-white">
		<nav class="max-w-6xl mx-auto px-4 h-16 flex items-center justify-between">
			<a href="/" class="font-semibold text-slate-900">FinTrack</a>
			<div class="flex items-center gap-3">
				<a href="/" class="text-sm text-slate-600 hover:text-slate-900">Home</a>
				<a href="/about" class="text-sm text-slate-600 hover:text-slate-900">About</a>
				<a href="/transactions" class="text-sm text-slate-600 hover:text-slate-900">Transactions</a>
				<a href="/budgets" class="text-sm text-slate-900 font-medium">Budgets</a>
				<a href="/profile" class="text-sm text-slate-600 hover:text-slate-900">Profile</a>
				<a href="/verify" class="text-sm text-slate-600 hover:text-slate-900">Verify</a>
			</div>
		</nav>
	</header>
	<main class="max-w-6xl mx-auto px-4 py-10">

		<div class="flex items-center justify-between mb-6">
			<h1 class="text-2xl font-semibold">Budgets</h1>
			<a href="/budgets/new" class="px-4 py-2 rounded-md bg-slate-900 text-white hover:bg-slate-800">Add Budget</a>
		</div>

		<div class="grid gap-4 md:grid-cols-2">
			<% items.forEach(b => { %>
				<div class="bg-white border rounded-md p-4">
					<div class="flex items-center justify-between">
						<div>
							<div class="text-sm text-slate-500">Budget</div>
							<div class="font-medium text-slate-900">
								<% const cat = categories.find(c => String(c.id) === String(b.categoryId)); %>
								<%= cat ? cat.name : 'General' %> â€” <%= b.month %>/<%= b.year %>
							</div>
						</div>
						<div>
							<a href="/budgets/<%= b.id %>/edit" class="text-slate-700 hover:text-slate-900">Edit</a>
							<form method="post" action="/budgets/<%= b.id %>/delete" class="inline-block ml-3" onsubmit="return confirm('Delete this budget?')">
								<button class="text-red-600 hover:text-red-700">Delete</button>
							</form>
						</div>
					</div>
					<div class="mt-4">
						<div class="flex items-center justify-between text-sm mb-2">
							<span class="text-slate-600">Spent</span>
							<span class="text-slate-900 font-medium"><%= (spendingMap[b.id] || 0).toFixed(2) %> / <%= Number(b.amount).toFixed(2) %> <%= b.currency %></span>
						</div>
						<% const spent = Number(spendingMap[b.id] || 0); const total = Number(b.amount); const pct = Math.min(100, Math.round((spent / (total || 1)) * 100)); const colorClass = (pct < 80 ? 'bg-green-500' : (pct < 100 ? 'bg-amber-500' : 'bg-red-500')); const widthClass = (pct >= 100 ? 'w-full' : (pct >= 75 ? 'w-3/4' : (pct >= 50 ? 'w-1/2' : (pct >= 25 ? 'w-1/4' : 'w-0')))); %>
						<div class="w-full h-2 bg-slate-200 rounded-full overflow-hidden">
							<div class="h-2 <%= colorClass %> <%= widthClass %>"></div>
						</div>
						<div class="text-xs text-slate-500 mt-1"><%= pct %>% used</div>
					</div>
				</div>
			<% }) %>
		</div>

	</main>
	<footer class="border-t bg-white">
		<div class="max-w-6xl mx-auto px-4 py-6 text-sm text-slate-500 flex items-center justify-between">
			<span>FinTrack</span>
			<span>&copy; <%= new Date().getFullYear() %></span>
		</div>
	</footer>
</body>
</html> 