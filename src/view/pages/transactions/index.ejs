<!DOCTYPE html>
<html lang="en" dir="ltr">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<title><%= title %></title>
	<script src="https://cdn.tailwindcss.com"></script>
	<link rel="preconnect" href="https://fonts.googleapis.com">
	<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
	<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
	<style>
		body { font-family: Inter, system-ui, -apple-system, Segoe UI, Roboto, Arial; }
	</style>
</head>
<body class="bg-slate-50 text-slate-900">
	<header class="border-b bg-white">
		<nav class="max-w-6xl mx-auto px-4 h-16 flex items-center justify-between">
			<a href="/" class="font-semibold text-slate-900">FinTrack</a>
			<div class="flex items-center gap-3">
				<a href="/" class="text-sm <%= (typeof path !== 'undefined' && path === '/') ? 'text-slate-900 font-medium' : 'text-slate-600 hover:text-slate-900' %>">Dashboard</a>
				<a href="/transactions" class="text-sm <%= (typeof path !== 'undefined' && path.startsWith('/transactions')) ? 'text-slate-900 font-medium' : 'text-slate-600 hover:text-slate-900' %>">Transactions</a>
				<a href="/budgets" class="text-sm <%= (typeof path !== 'undefined' && path.startsWith('/budgets')) ? 'text-slate-900 font-medium' : 'text-slate-600 hover:text-slate-900' %>">Budgets</a>
				<a href="/goals" class="text-sm <%= (typeof path !== 'undefined' && path.startsWith('/goals')) ? 'text-slate-900 font-medium' : 'text-slate-600 hover:text-slate-900' %>">Saving Goals</a>
				<% if (user) { %>
					<a href="/profile" class="text-sm <%= (typeof path !== 'undefined' && path.startsWith('/profile')) ? 'text-slate-900 font-medium' : 'text-slate-600 hover:text-slate-900' %>">Profile</a>
					<% if (!emailVerified) { %>
						<a href="/verify" class="text-sm text-amber-600 hover:text-amber-700">Verify Email</a>
					<% } %>
					<form action="/logout" method="post" class="inline-block">
						<button class="text-sm text-slate-600 hover:text-slate-900">Logout</button>
					</form>
				<% } else { %>
					<a href="/login" class="text-sm text-slate-600 hover:text-slate-900">Login</a>
					<a href="/register" class="text-sm text-slate-600 hover:text-slate-900">Register</a>
				<% } %>
			</div>
		</nav>
	</header>
	<main class="max-w-6xl mx-auto px-4 py-10">

		<div class="flex items-center justify-between mb-6">
			<h1 class="text-2xl font-semibold">Transactions</h1>
			<a href="/transactions/new" class="px-4 py-2 rounded-md bg-slate-900 text-white hover:bg-slate-800">Add Transaction</a>
		</div>

		<form method="get" action="/transactions" class="grid grid-cols-1 md:grid-cols-5 gap-3 bg-white p-4 rounded-md border mb-6">
			<div>
				<label class="text-xs text-slate-600">Type</label>
				<select name="type" class="mt-1 w-full border rounded-md px-2 py-2">
					<option value="">All</option>
					<option value="income" <%= filters.type === 'income' ? 'selected' : '' %>>Income</option>
					<option value="expense" <%= filters.type === 'expense' ? 'selected' : '' %>>Expense</option>
				</select>
			</div>
			
			<div class="flex items-end">
				<button class="w-full px-4 py-2 rounded-md bg-white border hover:bg-slate-50">Filter</button>
			</div>
		</form>

		<div class="overflow-x-auto bg-white rounded-md border">
			<table class="min-w-full text-sm">
				<thead class="bg-slate-50 text-slate-600">
					<tr>
						<th class="text-left px-4 py-3">Date</th>
						<th class="text-left px-4 py-3">Type</th>
						<th class="text-left px-4 py-3">Category</th>
						<th class="text-right px-4 py-3">Amount</th>
						<th class="text-left px-4 py-3">Currency</th>
						<th class="text-left px-4 py-3">Description</th>
						<th class="text-right px-4 py-3">Actions</th>
					</tr>
				</thead>
				<tbody>
					<% if (!items || items.length === 0) { %>
						<tr>
							<td colspan="7" class="px-4 py-6 text-center text-slate-500">No transactions found</td>
						</tr>
					<% } %>
					<% items.forEach(t => { %>
						<tr class="border-t">
							<td class="px-4 py-3"><%= new Date(t.occurredAt).toISOString().slice(0,10) %></td>
							<td class="px-4 py-3">
								<span class="inline-flex items-center px-2 py-1 rounded text-xs <%= t.type === 'income' ? 'bg-green-50 text-green-700' : 'bg-red-50 text-red-700' %>"><%= t.type %></span>
							</td>
							<td class="px-4 py-3">
								<% const cat = categories.find(c => String(c.id) === String(t.categoryId)); %>
								<%= cat ? cat.name : '-' %>
							</td>
							<td class="px-4 py-3 text-right font-medium"><%= Number(t.amount).toFixed(2) %></td>
							<td class="px-4 py-3"><%= t.currency %></td>
							<td class="px-4 py-3 text-slate-600"><%= t.description || '' %></td>
							<td class="px-4 py-3 text-right">
								<a href="/transactions/<%= t.id %>/edit" class="text-slate-700 hover:text-slate-900">Edit</a>
								<form method="post" action="/transactions/<%= t.id %>/delete" class="inline-block ml-3" onsubmit="return confirm('Delete this transaction?')">
									<button class="text-red-600 hover:text-red-700">Delete</button>
								</form>
							</td>
						</tr>
					<% }) %>
				</tbody>
			</table>
		</div>

		<% if (pagination.totalPages > 1) { %>
			<div class="flex items-center justify-between mt-4 text-sm">
				<div class="text-slate-600">Page <%= pagination.page %> of <%= pagination.totalPages %> (total <%= pagination.total %>)</div>
				<div class="flex items-center gap-2">
					<% const q = new URLSearchParams(filters); %>
					<% if (pagination.page > 1) { q.set('page', pagination.page - 1); %>
						<a class="px-3 py-1 border rounded" href="/transactions?<%= q.toString() %>">Prev</a>
					<% } %>
					<% if (pagination.page < pagination.totalPages) { q.set('page', pagination.page + 1); %>
						<a class="px-3 py-1 border rounded" href="/transactions?<%= q.toString() %>">Next</a>
					<% } %>
				</div>
			</div>
		<% } %>

	</main>
	<footer class="border-t bg-white">
		<div class="max-w-6xl mx-auto px-4 py-6 text-sm text-slate-500 flex items-center justify-between">
			<span>FinTrack</span>
			<span>&copy; <%= new Date().getFullYear() %></span>
		</div>
	</footer>
</body>
</html> 